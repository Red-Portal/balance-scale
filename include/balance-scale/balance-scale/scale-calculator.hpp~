#ifndef _SCALE_CALCULATOR_HPP_
#define _SCALE_CALCULATOR_HPP_

#include <vector> 
#include <chrono>
#include <optional> 
#include <utility>
#include <string>
#include <algorithm>

#include "measurer.hpp"
#include "complexity_functions.hpp"

namespace balance
{
    using clock = std::chrono::high_resolution_clock;
    using time_point = std::chrono::time_point< clock,
                                                std::nano >;
    using data_set = std::pair<int, time_point>;

    class scale_calculator
    {
    private:
        std::vector<std::optional<data_set>> _datas;

        inline complexity compute_compl_impl(data_set const& first,
                                             data_set const& second);
    public:
        inline scale_calculator();
        inline ~scale_calculator() =  default;

        inline measurer make_measurer();
        inline complexity compute_complexity();
    };


    // implementation

    scale_calculator::
    scale_calculator()
    {
        compl_funcs_init(); 
    }

    measurer
    scale_calculator::
    make_measurer()
    {
        _datas.push_back({});
        return measurer(_datas.back());
    }

    complexity
    scale_calculator::
    compute_complexity()
    {
        auto results = std::vector<complexity>();

        for(size_t i = 0; i < _datas.size(); ++i)
        {
            for(auto j = i; j < _datas.size(); ++j)
            {
                auto result = compute_compl_impl(_datas[i].value(),
                                                 _datas[j].value());
                results.push_back(result);
            }
        }
    }

    complexity
    scale_calculator::
    compute_compl_impl(data_set const& first,
                       data_set const& second)
    {
        for()
        {
            firs 
                }
    }
}

#endif
